<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DecAIders Â· Diagnostic augmentÃ© (aide contextuelle + roadmap)</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:opsz,wght@14..32,400;14..32,500;14..32,600;14..32,700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-deep: #0B2A4A;
      --primary-soft: #1E4A6F;
      --accent-gold: #F0B400;
      --accent-teal: #2C9A9A;
      --light-bg: #F4F7FC;
      --dark-bg: #1E2A3A;
      --border-rad: 24px;
    }
    body {
      background-color: var(--light-bg);
      font-family: 'Inter', sans-serif;
    }
    .navbar {
      background: var(--primary-deep);
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    .hero {
      background: linear-gradient(145deg, var(--primary-deep) 0%, #143b5c 100%);
      color: white;
      padding: 3rem 0;
      border-radius: 0 0 var(--border-rad) var(--border-rad);
      margin-bottom: 2rem;
    }
    .card-diagnostic {
      border: none;
      border-radius: var(--border-rad);
      background: white;
      box-shadow: 0 20px 35px -10px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    .dimension-header {
      background: var(--primary-deep);
      color: white;
      padding: 1rem 1.5rem;
      font-weight: 600;
      font-size: 1.25rem;
    }
    .question-item {
      padding: 0.75rem 1.5rem;
      border-bottom: 1px solid #e9ecef;
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 0.75rem;
    }
    .question-text {
      flex: 1 1 300px;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .help-icon {
      color: var(--primary-soft);
      cursor: pointer;
      font-size: 1.1rem;
      transition: 0.2s;
    }
    .help-icon:hover {
      color: var(--accent-gold);
    }
    .score-input {
      width: 90px;
      text-align: center;
      font-weight: 600;
      border-radius: 40px;
      border: 2px solid #dee2e6;
      padding: 0.3rem;
    }
    .score-input:focus {
      border-color: var(--accent-teal);
      outline: none;
      box-shadow: 0 0 0 3px rgba(44,154,154,0.2);
    }
    .result-badge {
      font-size: 2rem;
      font-weight: 700;
      padding: 0.5rem 1.5rem;
      border-radius: 60px;
    }
    .progress, .progress-bar {
      border-radius: 30px;
    }
    .dimension-card {
      background: #f8f9fa;
      border-radius: 20px;
      padding: 1.2rem;
      margin-bottom: 1rem;
    }
    .roadmap-item {
      border-left: 4px solid var(--accent-teal);
      padding: 1rem 1.5rem;
      background: #fefefe;
      border-radius: 12px;
      margin-bottom: 1rem;
    }
    .popover {
      background: var(--primary-deep);
      color: white;
      max-width: 300px;
    }
    .popover .popover-header {
      background: var(--accent-gold);
      color: var(--primary-deep);
      font-weight: 700;
    }
    .popover .popover-body {
      background: white;
      color: #212529;
    }
    .footer-note {
      background: var(--dark-bg);
      color: #adb5bd;
      border-radius: var(--border-rad) var(--border-rad) 0 0;
      padding: 2rem 0;
      margin-top: 3rem;
    }
  </style>
</head>
<body>

<!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-dark">
  <div class="container">
    <a class="navbar-brand" href="#"><i class="bi bi-diamond me-2" style="color: var(--accent-gold);"></i>DecAIdersÂ·diagnostic+</a>
    <button class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#nav"><span class="navbar-toggler-icon"></span></button>
    <div class="collapse navbar-collapse" id="nav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link active" href="#">Grille</a></li>
        <li class="nav-item"><a class="nav-link" href="#rapport">Rapport</a></li>
        <li class="nav-item"><a class="nav-link" href="#roadmap">Roadmap</a></li>
      </ul>
    </div>
  </div>
</nav>

<!-- Hero -->
<section class="hero">
  <div class="container text-center">
    <span class="badge bg-warning text-dark px-4 py-2 mb-3 fs-6">ğŸ§  COMITÃ‰ D'INNOVATION Â· DÃ‰CISION Ã‰CLAIRÃ‰E</span>
    <h1 class="display-4 fw-bold">Diagnostic stratÃ©gique augmentÃ©</h1>
    <p class="lead col-lg-8 mx-auto">20 critÃ¨res, 4 dimensions, aides contextuelles et feuille de route opÃ©rationnelle.</p>
  </div>
</section>

<main class="container mb-5">
  <!-- Grille interactive -->
  <section class="card-diagnostic mb-5" id="grille">
    <div class="dimension-header d-flex justify-content-between align-items-center">
      <span><i class="bi bi-clipboard-check me-2"></i>Grille de diagnostic Â· Cliquez sur <i class="bi bi-info-circle"></i> pour l'aide</span>
      <span class="badge bg-light text-dark">notation 1 (risque fort) â†’ 5 (maÃ®trisÃ©)</span>
    </div>
    <div class="p-4">
      <div id="questions-container"></div>

      <div class="d-flex flex-wrap gap-3 mt-4 mb-4">
        <button class="btn btn-primary btn-lg px-5 py-3" id="calculateBtn" style="background: var(--primary-deep);"><i class="bi bi-calculator-fill me-2"></i>GÃ©nÃ©rer le rapport & roadmap</button>
        <button class="btn btn-outline-secondary btn-lg px-4 py-3" id="resetBtn"><i class="bi bi-arrow-counterclockwise me-2"></i>RÃ©initialiser</button>
        <button class="btn btn-outline-warning btn-lg px-4 py-3" id="exampleBtn"><i class="bi bi-file-spreadsheet me-2"></i>Cas d'Ã©cole</button>
      </div>

      <!-- Zone de rapport dÃ©taillÃ© -->
      <div id="reportArea" style="display: none;">
        <hr class="my-4">
        <h3 class="fw-bold mb-4"><i class="bi bi-bar-chart-steps me-2"></i>Rapport d'Ã©valuation & feuille de route</h3>
        <div class="row g-4">
          <!-- score global -->
          <div class="col-lg-4">
            <div class="bg-light rounded-4 p-4 text-center h-100">
              <p class="text-uppercase text-muted mb-1">Score global</p>
              <div class="display-3 fw-bold" id="globalScore">0.0</div>
              <span class="badge fs-5 mt-2 px-4 py-2" id="globalBadge">-</span>
              <div class="progress mt-4" style="height:12px;"><div class="progress-bar" id="globalProgress" style="width:0%"></div></div>
            </div>
          </div>
          <!-- synthÃ¨se dÃ©cision -->
          <div class="col-lg-8">
            <div class="p-4 bg-white border rounded-4 h-100">
              <h5><i class="bi bi-chat-square-quote me-2" style="color:var(--accent-teal);"></i>Recommandation stratÃ©gique</h5>
              <p class="fs-5" id="recoText">...</p>
              <div id="strengthWeakness" class="mt-3 small"></div>
            </div>
          </div>
        </div>

        <!-- DÃ©tail par dimension (forces/faiblesses) -->
        <div class="row mt-4 g-4" id="dimensionDetails"></div>

        <!-- Roadmap actions -->
        <div class="mt-5">
          <h4 class="fw-bold"><i class="bi bi-signpost-split me-2" style="color:var(--accent-gold);"></i>Feuille de route priorisÃ©e (roadmap)</h4>
          <div id="roadmapList" class="mt-3"></div>
        </div>
      </div>
    </div>
  </section>
</main>

<footer class="footer-note">
  <div class="container text-center">
    <i class="bi bi-diamond-fill" style="color: var(--accent-gold);"></i>
    <p class="mt-2">DecAIders Â· Transformer lâ€™Ã©chec en mÃ©thode Â· 2025</p>
  </div>
</footer>

<!-- Bootstrap JS + Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
(function() {
  // === DÃ©finition des questions et aides contextuelles (tips, exemples) ===
  const questions = [
    { dim: 'A', text: 'Le problÃ¨me client est validÃ© par donnÃ©es terrain ?', default: 3,
      help: 'ğŸ” <strong>Contexte</strong> : Avez-vous menÃ© des entretiens, observations ou enquÃªtes qui confirment que le problÃ¨me est rÃ©el et frÃ©quent ?<br><br>ğŸ“Œ <strong>Tips</strong> : minimum 15 entretiens semi-directifs, identification des pains.<br>â­ <strong>Exemple 1</strong> : Aucune donnÃ©e â†’ 1. <br>ğŸ† <strong>Exemple 5</strong> : Ã‰tude terrain avec verbatims, taux de reconnaissance >80%.' },
    { dim: 'A', text: 'Le segment cible est clairement dÃ©fini ?', default: 4,
      help: 'ğŸ” <strong>Contexte</strong> : Savez-vous prÃ©cisÃ©ment qui sont les premiers utilisateurs (early adopters) ?<br>ğŸ“Œ <strong>Tips</strong> : persona, critÃ¨res dÃ©mographiques/psychographiques, canal dâ€™accÃ¨s.<br>â­ <strong>Exemple 1</strong> : "tout le monde" â†’ 1. <br>ğŸ† <strong>Exemple 5</strong> : persona dÃ©taillÃ© avec comportements, taille estimÃ©e.' },
    { dim: 'A', text: 'Le client paierait-il pour rÃ©soudre ce problÃ¨me ?', default: 2,
      help: 'ğŸ” <strong>Contexte</strong> : Avez-vous testÃ© la disposition Ã  payer (letter of intent, prÃ©ventes, benchmark) ?<br>ğŸ“Œ <strong>Tips</strong> : utilisez un prix fictif, prÃ©-commandes.<br>â­ <strong>Exemple 1</strong> : aucun test, supposition gratuite. <br>ğŸ† <strong>Exemple 5</strong> : 30% des prospects ont acceptÃ© un devis/achat.' },
    { dim: 'A', text: 'Le timing marchÃ© est favorable ?', default: 4,
      help: 'ğŸ” <strong>Contexte</strong> : y a-t-il une tendance, une rÃ©glementation, une saisonnalitÃ© qui rend le moment opportun ?<br>ğŸ“Œ <strong>Tips</strong> : analyse PEST, buzz concurrentiel.<br>â­ <strong>Exemple 1</strong> : marchÃ© en dÃ©clin. <br>ğŸ† <strong>Exemple 5</strong> : forte accÃ©lÃ©ration, feu vert lÃ©gal rÃ©cent.' },
    { dim: 'A', text: 'La proposition de valeur est diffÃ©renciante ?', default: 4,
      help: 'ğŸ” <strong>Contexte</strong> : en quoi votre solution est unique et difficile Ã  copier ?<br>ğŸ“Œ <strong>Tips</strong> : comparez aux alternatives existantes.<br>â­ <strong>Exemple 1</strong> : copie sans avantage. <br>ğŸ† <strong>Exemple 5</strong> : brevet, technologie exclusive, rÃ©seau.' },
    // B
    { dim: 'B', text: 'Avons-nous cherchÃ© des preuves que le projet peut Ã©chouer ?', default: 2,
      help: 'ğŸ” <strong>Contexte</strong> : avez-vous activement recherchÃ© des informations qui infirment vos hypothÃ¨ses ?<br>ğŸ“Œ <strong>Tips</strong> : "pre-mortem", tests de falsification.<br>â­ <strong>Exemple 1</strong> : on a Ã©vitÃ© les mauvaises nouvelles. <br>ğŸ† <strong>Exemple 5</strong> : protocole de test avec hypothÃ¨ses risquÃ©es validÃ©es/invalidÃ©es.' },
    { dim: 'B', text: 'Une voix contradictoire a-t-elle Ã©tÃ© entendue ?', default: 3,
      help: 'ğŸ” <strong>Contexte</strong> : lors des dÃ©libÃ©rations, des avis divergents ont-ils Ã©tÃ© exprimÃ©s et pris en compte ?<br>ğŸ“Œ <strong>Tips</strong> : rÃ´le "avocat du diable", vote Ã  bulletin secret.<br>â­ <strong>Exemple 1</strong> : pensÃ©e unique, aucune opposition. <br>ğŸ† <strong>Exemple 5</strong> : sÃ©ance dÃ©diÃ©e avec contre-arguments documentÃ©s.' },
    { dim: 'B', text: 'DÃ©cision basÃ©e sur donnÃ©es testÃ©es ?', default: 4,
      help: 'ğŸ” <strong>Contexte</strong> : les chiffres clÃ©s (conversion, rÃ©tention) proviennent dâ€™expÃ©riences rÃ©elles ?<br>ğŸ“Œ <strong>Tips</strong> : MVP, A/B test, prototype.<br>â­ <strong>Exemple 1</strong> : dÃ©cision sur intuition. <br>ğŸ† <strong>Exemple 5</strong> : donnÃ©es probantes issues dâ€™un test grandeur nature.' },
    { dim: 'B', text: 'Attachement Ã©motionnel dÃ©tectÃ© ? (1 = fort, 5 = aucun)', default: 2,
      help: 'ğŸ” <strong>Contexte</strong> : le sponsor ou le porteur est-il aveuglÃ© par son affection pour le projet ?<br>ğŸ“Œ <strong>Tips</strong> : questionnez "si vous quittiez lâ€™entreprise, le projet continuerait-il ?".<br>â­ <strong>Exemple 1</strong> : "câ€™est mon bÃ©bÃ©", refus dâ€™Ã©couter. <br>ğŸ† <strong>Exemple 5</strong> : dÃ©tachement, dÃ©cision purement rationnelle.' },
    { dim: 'B', text: 'Relancerions-nous ce projet aujourd\'hui ?', default: 3,
      help: 'ğŸ” <strong>Contexte</strong> : avec lâ€™Ã©tat actuel des connaissances, repartirions-nous de zÃ©ro sur cette idÃ©e ?<br>ğŸ“Œ <strong>Tips</strong> : test de la "page blanche".<br>â­ <strong>Exemple 1</strong> : non, trop dâ€™engagement. <br>ğŸ† <strong>Exemple 5</strong> : oui, sans hÃ©sitation.' },
    // C
    { dim: 'C', text: 'Sponsor exÃ©cutif clair ?', default: 5,
      help: 'ğŸ” <strong>Contexte</strong> : un membre du comitÃ© de direction est-il nommÃ©ment responsable du succÃ¨s ?<br>ğŸ“Œ <strong>Tips</strong> : il dÃ©bloque les ressources.<br>â­ <strong>Exemple 1</strong> : aucun sponsor identifiÃ©. <br>ğŸ† <strong>Exemple 5</strong> : sponsor actif, prÃ©sent aux revues.' },
    { dim: 'C', text: 'ResponsabilitÃ©s dÃ©finies ?', default: 4,
      help: 'ğŸ” <strong>Contexte</strong> : qui fait quoi (PO, chef de projet, Ã©quipe) est formalisÃ©.<br>ğŸ“Œ <strong>Tips</strong> : RACI, fiches de poste.<br>â­ <strong>Exemple 1</strong> : flou total. <br>ğŸ† <strong>Exemple 5</strong> : matrice claire et acceptÃ©e.' },
    { dim: 'C', text: 'CompÃ©tences clÃ©s prÃ©sentes ?', default: 3,
      help: 'ğŸ” <strong>Contexte</strong> : les talents nÃ©cessaires (technique, mÃ©tier, commercial) sont-ils dans lâ€™Ã©quipe ?<br>ğŸ“Œ <strong>Tips</strong> : Ã©cart de compÃ©tences, plan de formation.<br>â­ <strong>Exemple 1</strong> : absence critique. <br>ğŸ† <strong>Exemple 5</strong> : Ã©quipe complÃ¨te et expÃ©rimentÃ©e.' },
    { dim: 'C', text: 'Ressources adaptÃ©es ?', default: 3,
      help: 'ğŸ” <strong>Contexte</strong> : budget, temps, outils allouÃ©s sont-ils suffisants ?<br>ğŸ“Œ <strong>Tips</strong> : comparez avec des projets similaires.<br>â­ <strong>Exemple 1</strong> : sous-dimensionnement chronique. <br>ğŸ† <strong>Exemple 5</strong> : ressources dÃ©diÃ©es et protÃ©gÃ©es.' },
    { dim: 'C', text: 'CapacitÃ© d\'industrialisation validÃ©e ?', default: 2,
      help: 'ğŸ” <strong>Contexte</strong> : si le projet passe Ã  lâ€™Ã©chelle, pourra-t-on produire / livrer en volume ?<br>ğŸ“Œ <strong>Tips</strong> : pilote industriel, partenaires.<br>â­ <strong>Exemple 1</strong> : pas de rÃ©flexion sur le scale. <br>ğŸ† <strong>Exemple 5</strong> : prototype industriel testÃ©.' },
    // D
    { dim: 'D', text: 'ModÃ¨le Ã©conomique testÃ© ?', default: 2,
      help: 'ğŸ” <strong>Contexte</strong> : le business model a-t-il Ã©tÃ© confrontÃ© Ã  de vrais clients (ex: pop-up store, campagne) ?<br>ğŸ“Œ <strong>Tips</strong> : lean canvas, tests unitaires.<br>â­ <strong>Exemple 1</strong> : modÃ¨le thÃ©orique non testÃ©. <br>ğŸ† <strong>Exemple 5</strong> : pilote rentable sur petit Ã©chantillon.' },
    { dim: 'D', text: 'HypothÃ¨ses validÃ©es ?', default: 3,
      help: 'ğŸ” <strong>Contexte</strong> : les principales hypothÃ¨ses (taux de conversion, panier moyen) ont-elles Ã©tÃ© vÃ©rifiÃ©es ?<br>ğŸ“Œ <strong>Tips</strong> : liste des hypothÃ¨ses risquÃ©es.<br>â­ <strong>Exemple 1</strong> : toutes non testÃ©es. <br>ğŸ† <strong>Exemple 5</strong> : au moins 80% validÃ©es par donnÃ©es.' },
    { dim: 'D', text: 'CoÃ»t d\'acquisition estimÃ© ?', default: 3,
      help: 'ğŸ” <strong>Contexte</strong> : savez-vous combien coÃ»te lâ€™obtention dâ€™un client (CAC) ?<br>ğŸ“Œ <strong>Tips</strong> : campagnes tests, benchmark.<br>â­ <strong>Exemple 1</strong> : inconnu. <br>ğŸ† <strong>Exemple 5</strong> : CAC mesurÃ© et infÃ©rieur Ã  la LTV.' },
    { dim: 'D', text: 'Seuil de rentabilitÃ© rÃ©aliste ?', default: 2,
      help: 'ğŸ” <strong>Contexte</strong> : le volume de vente nÃ©cessaire pour couvrir les coÃ»ts est-il atteignable ?<br>ğŸ“Œ <strong>Tips</strong> : scÃ©narios pessimiste, rÃ©aliste.<br>â­ <strong>Exemple 1</strong> : seuil utopique. <br>ğŸ† <strong>Exemple 5</strong> : seuil basÃ© sur des donnÃ©es de marchÃ©.' },
    { dim: 'D', text: 'KPI d\'impact dÃ©finis ?', default: 4,
      help: 'ğŸ” <strong>Contexte</strong> : des indicateurs prÃ©cis (ROI, NPS, part de marchÃ©) sont-ils Ã©tablis ?<br>ğŸ“Œ <strong>Tips</strong> : OKRs, dashboard.<br>â­ <strong>Exemple 1</strong> : pas de KPI. <br>ğŸ† <strong>Exemple 5</strong> : KPI SMART et suivis mensuellement.' }
  ];

  const dimNames = {
    A: 'ProblÃ¨me & MarchÃ©',
    B: 'Biais & DÃ©cision',
    C: 'ExÃ©cution & Organisation',
    D: 'Ã‰conomie & ROI'
  };

  // Rendu des questions avec icÃ´ne d'aide (popover)
  function renderQuestions() {
    let html = '';
    ['A','B','C','D'].forEach(d => {
      html += `<div class="mt-3 mb-2"><h5 class="fw-bold" style="color: var(--primary-deep);">${dimNames[d]}</h5></div>`;
      questions.filter(q => q.dim === d).forEach((q, idx) => {
        const uniqueId = `q-${d}-${idx}`;
        html += `
          <div class="question-item" id="${uniqueId}">
            <span class="question-text">
              ${q.text}
              <i class="bi bi-info-circle help-icon" tabindex="0" role="button" data-bs-toggle="popover" data-bs-trigger="focus" data-bs-html="true" title="Aide contextuelle" data-bs-content="${q.help.replace(/"/g, '&quot;')}"></i>
            </span>
            <input type="number" class="score-input" min="1" max="5" step="1" value="${q.default}" data-dim="${d}">
          </div>
        `;
      });
    });
    document.getElementById('questions-container').innerHTML = html;

    // Activer les popovers Bootstrap
    const popoverTriggerList = document.querySelectorAll('[data-bs-toggle="popover"]');
    popoverTriggerList.forEach(el => new bootstrap.Popover(el, { container: 'body' }));
  }

  renderQuestions();

  // Collecte des scores
  function collectScores() {
    const inputs = document.querySelectorAll('.score-input');
    const scoresByDim = { A: [], B: [], C: [], D: [] };
    inputs.forEach(inp => {
      const dim = inp.dataset.dim;
      let val = parseInt(inp.value, 10);
      if (isNaN(val) || val < 1) val = 1;
      if (val > 5) val = 5;
      inp.value = val; // correction
      scoresByDim[dim].push(val);
    });
    return scoresByDim;
  }

  // Calcul et rapport
  function generateReport() {
    const scores = collectScores();
    const dims = ['A','B','C','D'];
    const dimAvg = {};
    let totalSum = 0, totalCount = 0;
    dims.forEach(d => {
      const arr = scores[d];
      const avg = arr.reduce((a,b)=>a+b,0) / arr.length;
      dimAvg[d] = avg;
      totalSum += avg * arr.length;
      totalCount += arr.length;
    });
    const overallAvg = totalSum / totalCount;
    const overallPct = (overallAvg / 5) * 100;

    // Affichage global
    document.getElementById('globalScore').innerText = overallAvg.toFixed(2);
    document.getElementById('globalProgress').style.width = overallPct + '%';

    let badgeClass, badgeText, decisionLevel;
    if (overallPct < 50) { badgeClass = 'bg-danger'; badgeText = 'ğŸ”´ STOP / PIVOT'; decisionLevel = 'STOP'; }
    else if (overallPct < 70) { badgeClass = 'bg-warning text-dark'; badgeText = 'ğŸŸ  FRAGILE'; decisionLevel = 'FRAGILE'; }
    else { badgeClass = 'bg-success'; badgeText = 'ğŸŸ¢ GO (conditionnel)'; decisionLevel = 'GO'; }
    const badge = document.getElementById('globalBadge');
    badge.className = `badge fs-5 px-4 py-2 ${badgeClass}`;
    badge.innerText = badgeText;

    // Recommandation textuelle
    let reco = '';
    if (decisionLevel === 'STOP') reco = 'Le projet cumule trop de risques critiques. Il est impÃ©ratif de stopper ou de redÃ©marrer sur une base diffÃ©rente (pivot radical). Les scores les plus bas se situent souvent dans les dimensions B et D.';
    else if (decisionLevel === 'FRAGILE') reco = 'Des points de fragilitÃ© nÃ©cessitent des actions correctives avant tout investissement significatif. Concentrez les efforts sur les dimensions sous la moyenne et reâ€‘Ã©valuez dans 2â€‘3 mois.';
    else reco = 'Le projet est bien positionnÃ©. Vous pouvez envisager un financement progressif, mais restez vigilant sur les biais et continuez Ã  mesurer les hypothÃ¨ses Ã©conomiques.';
    document.getElementById('recoText').innerText = reco;

    // Forces / faiblesses (questions individuelles)
    const allQuestions = [];
    document.querySelectorAll('.question-item').forEach((item, idx) => {
      const input = item.querySelector('.score-input');
      const questionText = item.querySelector('.question-text').childNodes[0].nodeValue.trim();
      const dim = input.dataset.dim;
      const val = parseInt(input.value);
      allQuestions.push({ dim, text: questionText, score: val });
    });

    const weak = allQuestions.filter(q => q.score <= 2).sort((a,b) => a.score - b.score);
    const strong = allQuestions.filter(q => q.score >= 4).sort((a,b) => b.score - a.score);

    let swHtml = '<strong>âš¡ Principales forces :</strong> ';
    swHtml += strong.slice(0,3).map(q => q.text.split('?')[0]).join(' ; ') || 'aucune note >3';
    swHtml += '<br><strong>âš ï¸ Faiblesses critiques :</strong> ';
    swHtml += weak.slice(0,4).map(q => q.text.split('?')[0]).join(' ; ') || 'aucune note â‰¤2';
    document.getElementById('strengthWeakness').innerHTML = swHtml;

    // DÃ©tail par dimension (progress bars + commentaires)
    let dimHtml = '';
    dims.forEach(d => {
      const pct = (dimAvg[d] / 5) * 100;
      const color = pct < 50 ? 'danger' : (pct < 70 ? 'warning' : 'success');
      dimHtml += `
        <div class="col-md-6">
          <div class="dimension-card">
            <div class="d-flex justify-content-between"><span class="fw-bold">${dimNames[d]}</span> <span class="badge bg-${color}">${dimAvg[d].toFixed(2)} / 5</span></div>
            <div class="progress mt-2" style="height:10px;"><div class="progress-bar bg-${color}" style="width:${pct}%"></div></div>
            <div class="small mt-2">${getDimComment(d, dimAvg[d])}</div>
          </div>
        </div>
      `;
    });
    document.getElementById('dimensionDetails').innerHTML = dimHtml;

    // Roadmap (feuille de route)
    const roadmap = generateRoadmap(scores, dimAvg, weak, strong);
    document.getElementById('roadmapList').innerHTML = roadmap;

    document.getElementById('reportArea').style.display = 'block';
    window.scrollTo({ top: document.getElementById('reportArea').offsetTop - 100, behavior: 'smooth' });
  }

  function getDimComment(dim, avg) {
    if (avg < 2.5) return 'ğŸ”´ Urgent : action immÃ©diate requise.';
    if (avg < 3.5) return 'ğŸŸ  Ã€ renforcer dans les 3 mois.';
    return 'ğŸŸ¢ Bon niveau, Ã  maintenir.';
  }

  function generateRoadmap(scoresByDim, dimAvg, weakQuestions, strongQuestions) {
    let steps = [];

    // Ã‰tape 1 : traiter les faiblesses â‰¤ 2 en prioritÃ©
    weakQuestions.slice(0,5).forEach(q => {
      steps.push(`ğŸ”¹ <strong>${q.text}</strong> â€” Plan dâ€™action : organiser un atelier de validation (ex: entretiens complÃ©mentaires, analyse contradictoire, preuve de concept).`);
    });

    // Ã‰tape 2 : dimension la plus faible
    const dimOrder = Object.keys(dimAvg).sort((a,b) => dimAvg[a] - dimAvg[b]);
    const worstDim = dimOrder[0];
    steps.push(`ğŸ”¸ <strong>PrioritÃ© dimension ${dimNames[worstDim]}</strong> â€” Lancer un audit flash et dÃ©signer un pilote dâ€™amÃ©lioration. Ã‰chÃ©ance : 1 mois.`);

    // Ã‰tape 3 : action sur les biais si dimension B faible
    if (dimAvg['B'] < 3) {
      steps.push(`ğŸ”¸ <strong>Protocole anti-biais</strong> : organiser un prÃ©â€‘mortem formel et un vote anonyme avant le prochain comitÃ©.`);
    }

    // Ã‰tape 4 : test Ã©conomique
    if (dimAvg['D'] < 3) {
      steps.push(`ğŸ”¸ <strong>Validation Ã©conomique</strong> : lancer un test de disposition Ã  payer sur un Ã©chantillon de 50 clients potentiels.`);
    }

    // Ã‰tape 5 : roadmap de reâ€‘Ã©valuation
    steps.push(`ğŸ“… <strong>Reâ€‘Ã©valuation</strong> : programmer un point de contrÃ´le dans 8 semaines avec les mÃªmes critÃ¨res.`);

    let html = '<ol class="list-unstyled">';
    steps.forEach(s => html += `<li class="roadmap-item">${s}</li>`);
    html += '</ol>';
    return html;
  }

  function resetScores() {
    const inputs = document.querySelectorAll('.score-input');
    questions.forEach((q, idx) => { if (inputs[idx]) inputs[idx].value = q.default; });
    document.getElementById('reportArea').style.display = 'none';
  }

  function loadExample() {
    const example = [2,3,2,4,3, 2,2,3,2,3, 5,4,3,3,2, 2,2,2,1,3]; // conforme Ã  l'ordre
    const inputs = document.querySelectorAll('.score-input');
    inputs.forEach((inp, i) => { if (example[i]) inp.value = example[i]; });
  }

  document.getElementById('calculateBtn').addEventListener('click', generateReport);
  document.getElementById('resetBtn').addEventListener('click', resetScores);
  document.getElementById('exampleBtn').addEventListener('click', function() {
    loadExample();
    generateReport();
  });

})();
</script>
</body>
</html>